
# Conversational SQL Query Generator

This project is a Streamlit web application that enables users to interact with a SQL database using natural language. A user can ask a question in plain English, and the application will generate the corresponding SQL query, execute it against the database, and display the results. The application maintains a conversational history, allowing for contextual follow-up questions.

This system leverages Google's Gemini large language model through the LangChain framework to interpret user input and translate it into a valid SQL query based on the provided database schema.

---

## Features

- **Natural Language to SQL**: Translates user questions into executable SQL queries.
- **Interactive Chat Interface**: Provides a user-friendly chat interface built with Streamlit for intuitive interaction.
- **Conversation History**: Maintains the context of the conversation to accurately handle follow-up questions.
- **Database Schema Viewer**: Offers an expandable section to display the database schema, helping users understand the data structure.
- **SQL Query Display**: Shows the generated SQL query to the user for transparency.
- **Formatted Results**: Presents query results in a clean, readable Pandas DataFrame.

---

## Tech Stack

- **Frontend**: Streamlit
- **Language Model**: Google Gemini
- **LLM Framework**: LangChain
- **Database**: SQLite
- **Core Libraries**: Pandas, python-dotenv, SQLAlchemy

---

## Getting Started

Follow these instructions to set up and run a local instance of the project.

### Prerequisites

- Python 3.8+
- An active Google API Key

### Installation and Setup

#### Clone the Repository

```bash
git clone <your-repository-url>
cd <your-repository-name>
````

#### Create and Activate a Virtual Environment

It is highly recommended to use a virtual environment to manage project dependencies.

```bash
# For macOS/Linux
python3 -m venv venv
source venv/bin/activate

# For Windows
python -m venv venv
venv\Scripts\activate
```

#### Install Dependencies

Install all required Python packages from the `requirements.txt` file.

```bash
pip install -r requirements.txt
```

#### Set Up the Database

Run the setup script to create the local SQLite database (`sample_database.db`) and populate it with initial data.

```bash
python data/setup_database.py
```

A success message will confirm that the database has been created in the `data/` directory.

#### Configure Environment Variables

Create a `.env` file in the root directory of the project. Add your Google API Key to this file.

```env
GOOGLE_API_KEY="YOUR_GOOGLE_API_KEY"
```

Replace `YOUR_GOOGLE_API_KEY` with your actual key obtained from [Google AI Studio](https://aistudio.google.com).

#### Run the Streamlit Application

Launch the web application using the Streamlit CLI.

```bash
streamlit run app.py
```

The application will now be running and accessible at the local URL provided in your terminal (typically `http://localhost:8501`).

---

## Usage

1. Open the application in your web browser.
2. Optionally, expand the "View Database Schema" section to see the available tables and columns.
3. In the chat input box at the bottom, type a question about the data (e.g., *"How many employees work in the Sales department?"*).
4. The application will display the generated SQL query.
5. The results from executing the query will be displayed in a formatted table.
6. You can ask contextual follow-up questions (e.g., *"Of those, who was hired most recently?"*).

---

## Project Structure

```
.
├── app.py                  # Main Streamlit application file
├── core
│   ├── db_connector.py     # Handles database connection, schema retrieval, and query execution
│   └── query_generator.py  # Manages LLM interaction for SQL generation
├── data
│   ├── sample_database.db  # SQLite database file (generated by setup script)
│   └── setup_database.py   # Script to create and populate the database
├── requirements.txt        # A list of all Python package dependencies
└── .env                    # Environment variables file (to be created by user)
```

```

